
      <div class="sidebar">
         <form name="customerCredentials" id="customerCredentials">
           <div class="block form-group">
              <span style="color:white"><b>OCLC API Key</b></span>
              <br>
              <input type="text" id="apiKey" name="apiKey" placeholder="api key (required)" value=""/>
              <br>
              <span style="color:white"><b>OCLC API secret</b></span>
              <br>
              <input type="text" id="apiSecret" name="apiSecret" placeholder="api secret (required)" value=""/>
              <br>               
           </div>
           
           <br>
           
         <div class="block form-group">
              <input type="button" class="action" value="Save Credentials" onclick="submitCredentials()" />
         </div>
         <br>         
         
         </form>
         <br>
     </div>
     
         <script>
    
        // The code in this function runs when the page is loaded.
        // getTabs is a server side function in Code.gs
        $(function() {         
           google.script.run.withSuccessHandler(setKey).getStoredAPIKey();
           google.script.run.withSuccessHandler(setSecret).getStoredAPISecret();
        });
        
        function setKey(apiKey){
            if (apiKey == null  || apiKey === undefined) apiKey = "";
            document.getElementById('apiKey').value=apiKey;
       
          }
        function setSecret(apiSecret){
            if (apiSecret == null  || apiSecret === undefined) apiSecret = "";
            document.getElementById('apiSecret').value=apiSecret;
       
          }
        function submitCredentials(){
            google.script.run.saveCredentials(document.getElementById('customerCredentials'));
            google.script.host.close() 
          }        
       
        
        </script>